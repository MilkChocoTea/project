# 機械手臂倉儲系統

## 系統架構

[image.png]

1. HTML 前端

    - 提供操作介面，顯示系統控制、資料管理、人員管理、機台狀態、倉庫管理、報表等功能。
    - 與後端系統透過 HTTPS 溝通，進行請求/回應，接收並呈現資料。

2. 後端系統 (Web Server)

    - 核心業務邏輯(系統控制、倉儲/物流流程、報表生成)。
    - 接收前端請求並處理後，與 PostgreSQL 資料庫 或 機械手臂系統 溝通。
    - 可使用 Python (Flask / Django / FastAPI) 或 Node.js、Java (Spring Boot) 等技術實作。
    - 封裝一組 API 提供給前端使用(RESTful API 或 GraphQL 皆可)，同時亦可使用 HTTPS 或其他工控協定與機械手臂系統進行資料交換。

3. PostgreSQL 資料庫

    - 存放系統所有數據，如：
        - 使用者/人員管理(帳號、角色、權限等)
        - 倉庫/庫存管理(貨品、數量、入庫/出庫紀錄等)
        - 機台/設備管理(狀態、維修紀錄)
        - 報表/歷史紀錄(系統操作紀錄、動作日誌等)
    - 可由後端系統與機械手臂系統雙向讀寫(視需求設計)。

4. 機械手臂系統 (Python + PyQt)

    - (A) 初始化與環境檢查：檢查並安裝系統套件(依賴包、韌體等)。
    - (B) 連接 PostgreSQL 並初始化資料表(若此部分屬於機械手臂系統本身需要記錄的資料，如動作紀錄、錯誤日誌等)。
    - (C) PyQt GUI：
        - 提供局部或在機台附近可視化控制的圖形介面(按鈕/狀態顯示等)。
        - 監控/顯示機械手臂當前動作、狀態、感測器參數。
        - 操作人員可透過 PyQt GUI 做手動/半自動控制(維修測試/手動校正)。
    - (D) Motor.py：
        - 實際控制伺服馬達的轉角(PWM)、執行動作流程。
        - 可接收後端系統下發的動作指令(經 HTTPS 或其他工控通訊協定)，並執行對應動作(搬運、抓取、輸送等)。
        - 根據動作結果(成功/失敗/異常)回傳狀態或錯誤碼給後端系統或寫入資料庫。


## 系統功能

### 一、前端（HTML 介面）

1. 系統控制

    - 提供系統啟動、停止、重置、急停等操作按鈕
    - 顯示當前系統運行模式（自動/手動/維修模式等）

2. 資料管理

    - 貨品資料維護（新增、編輯、刪除）
    - 倉儲位置與庫存管理（查詢、調整、批次匯入/匯出）
    - 操作紀錄查詢與篩選

3. 人員管理

    - 角色與權限設定（管理者、操作員、維修員等）
    - 帳號管理（註冊、登入、密碼重設）
    - 人員操作日誌與權限檢視

4. 機台（設備）狀態

    - 即時顯示機械手臂狀態（運轉中、待機中、故障等）
    - 監控感測器或馬達參數（電流、溫度、位置等）
    - 通知或警示（異常告警、維修提醒）

5. 倉庫管理

    - 入庫／出庫任務管理（新增指令、任務排程、任務歷史紀錄）
    - 貨架、料箱位置編碼與配置查詢
    - 與機械手臂聯動，顯示自動化進出料流程

6. 報表管理

    - 庫存報表、出入庫報表、異常報表等生成或匯出（CSV、Excel、PDF）
    - 圖表化呈現（折線圖、長條圖、圓餅圖），輔助庫存分析或設備故障率分析
    - 報表下載與歷史紀錄查詢

### 二、後端（系統伺服器與 API）

1. API 服務

    - 提供 RESTful API 或其他協定（HTTPS），供前端與機械手臂系統存取
    - 使用者驗證與授權（JWT / Session 等）
    - 接收前端指令後，調度機械手臂動作或查詢/更新資料庫

2. 系統邏輯與流程管理

    - 倉儲流程：進貨、出貨、盤點、補貨等
    - 物流流程：訂單管理、出貨紀錄、貨物追蹤
    - 任務排程：同時管理多個機械手臂或設備的工作，優先權配置

3. 資料管理與整合

    - 與 PostgreSQL 進行資料讀寫（貨品、庫存、人員、操作日誌等）
    - 整合機械手臂回傳的狀態訊息與感測器資料
    - 整合報表產生模組，生成並儲存或回傳給前端

4. 權限與安全

    - 依角色分配可使用的功能（前端介面、API 存取）
    - HTTPS/TLS 加密通訊，避免敏感資訊外洩
    - 日誌與異常處理：記錄所有操作與錯誤，並主動通知

5. 報表與通知

    - 自動化報表排程（每日、每週、每月）
    - 通知服務（Email、簡訊、App 推播）以提醒人員系統異常或維修到期

### 三、資料庫（PostgreSQL）

1. 基礎資料表

    - 使用者資料表（帳號、密碼雜湊、角色、權限）
    - 倉儲資料表（貨品資訊、庫存量、貨架位置）
    - 機械手臂/設備資料表（型號、參數、維修紀錄、動作日誌）
    - 報表/日誌紀錄表（各類操作紀錄、下載紀錄、報表生成紀錄）

2. 交易與鎖定機制

    - 確保同時多人操作時，資料不會衝突
    - 避免重複扣庫存或錯誤更新資料

3. 備份與還原

    - 排程定期備份資料庫（pg_dump、pg_basebackup）
    - 遇到系統崩潰或硬體故障時，可進行災難復原

4. 效能調校

    - 依照資料讀寫頻率與查詢條件，建立適當索引
    - 若感測器或設備回傳大量即時數據，可考慮儲存於時序型資料庫或分區表

### 四、機械手臂系統（Python + PyQt）

1. 系統檢查與環境初始化

    - 檢查並安裝必要套件、韌體
    - 與 PostgreSQL 連線並初始化資料表（若需在此系統本地存取或記錄動作日誌）

2. GUI（PyQt 介面）

    - 提供現場操作人員使用（手動校正、檢修、緊急停止）
    - 實時顯示機械手臂運行狀態與感測器數值
    - 顯示錯誤或警告訊息

3. Motor.py（動作控制核心）

    - 控制伺服馬達（PWM）與動作流程（抓取、移動、放置）
    - 接收後端下達的指令（經由 API 或 Socket 通訊）
    - 依照指令完成動作後，回傳執行狀態或更新資料庫

4. 故障偵測與通報

    - 若偵測馬達過熱、卡住或感測器異常，立即通知後端
    - 異常狀態自動紀錄並列入維修日誌

### 五、整體綜合功能重點
1. 自動化倉儲管理

    - 機械手臂自動完成貨品出入庫、庫位整理
    - 前端可隨時查看庫存與進出貨紀錄

2. 設備即時監控

    - 透過機台狀態畫面，監控機械手臂、感測器、馬達等健康狀況
    - 系統異常時立即顯示警告並記錄

3. 人員與權限控管

    - 依角色分配不同的操作範圍與查看權限
    - 確保關鍵操作僅授權人員可執行

4. 報表與分析

    - 多種統計或分析報表，如庫存趨勢、出貨效率、機台利用率
    - 輔助管理者做決策與成本控制

5. 維修與保養

    - 系統自動紀錄機械手臂運行時數，提醒定期保養
    - 維修人員可在前端或 PyQt GUI 查看異常紀錄，安排檢修計畫
